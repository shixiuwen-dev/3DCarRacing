const axios = require("axios"); const cheerio = require("cheerio"); const fs = require("fs").promises; const path = require("path"); const CATEGORIES = ["racing", "action", "strategy", "arcade", "sports", "puzzle"]; const BASE_URL = "https://www.crazygames.com"; async function fetchGames(category) { try { console.log(`Fetching ${category} games...`); const response = await axios.get(`${BASE_URL}/c/${category}-games`); const $ = cheerio.load(response.data); const games = []; $(".game-tile").each((i, elem) => { const title = $(elem).find(".game-tile__title").text().trim(); const description = $(elem).find(".game-tile__description").text().trim(); const imageUrl = $(elem).find("img").attr("src"); const gameUrl = $(elem).find("a").attr("href"); if (title && gameUrl) { games.push({ title, description, imageUrl, gameUrl: `${BASE_URL}${gameUrl}`, category }); } }); return games; } catch (error) { console.error(`Error fetching ${category} games:`, error.message); return []; } } async function generateGamePage(game) { const template = `<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>${game.title} | WorkMoyu Games</title><script src="https://cdn.tailwindcss.com"></script></head><body class="bg-gaming-dark text-white"><div id="game-container" style="width: 100%; height: 100vh;"><iframe src="${game.gameUrl}" style="width: 100%; height: 100%;" frameborder="0" allow="gamepad *;" allowfullscreen></iframe></div></body></html>`; const filename = `${game.title.toLowerCase().replace(/[^a-z0-9]/g, "-")}.html`; const filepath = path.join(__dirname, "..", "games", game.category, filename); try { await fs.mkdir(path.dirname(filepath), { recursive: true }); await fs.writeFile(filepath, template, "utf8"); console.log(`Generated game page: ${filepath}`); } catch (error) { console.error(`Error generating game page for ${game.title}:`, error.message); } } async function main() { for (const category of CATEGORIES) { const games = await fetchGames(category); console.log(`Found ${games.length} ${category} games`); for (const game of games) { await generateGamePage(game); } } } main().catch(console.error);
